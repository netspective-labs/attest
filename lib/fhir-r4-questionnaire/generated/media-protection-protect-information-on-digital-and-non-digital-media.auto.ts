/**
 * @file media-protection-protect-information-on-digital-and-non-digital-media.auto.ts
 * @generated This file was auto-generated at 2025-08-17T01:00:18.925Z from the FHIR R4 Questionnaire "Media Protection (Protect information on digital and non-digital media)".
 * Do not edit this file manually; re-run the generator if the source Questionnaire changes.
 * Profiles: http://hl7.org/fhir/4.0/StructureDefinition/Questionnaire
 *
 * Normalizes LHC JSON and FHIR QuestionnaireResponse into the type-safe `MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia` interface.
 */

// deno-lint-ignore no-explicit-any
type Any = any;
import {
  coerceOptionalString,
  findLhcValueByLinkId,
  findQrAnswerByLinkId,
  isBlank,
} from "../r4q-runtime.ts";
/**
 * Form Help (from display/help controls):
 * - Practice: Sanitize or destroy information system media containing Federal Contract Information before disposal or release for reuse
 * - Define and document policies for handling, storing, and disposing of media to prevent unauthorized access and data loss.
 */
/** Map of normalized property names to their source `linkId`. */
export const MediaProtectionProtectInformationOnDigitalAndNonDigitalMediaLinkIds =
  {
    doYouHaveAMediaDisposalPolicy: "957584520694",
    implementationStatus: "272642906092",
    confirmThatYourMediaDisposalPolicyIncludesTheFollowingElementsClickAllThatApply:
      "698818405059",
  } as const;

/** Normalized view of "Media Protection (Protect information on digital and non-digital media)" answers. */
export interface MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia {
  /**
   * Do you have a Media Disposal Policy?
   * linkId: 957584520694
   * FHIR type: choice
   * Options: "Yes", "No"
   * Required: no
   */
  doYouHaveAMediaDisposalPolicy?: "Yes" | "No";

  /**
   * Implementation Status
   * linkId: 272642906092
   * FHIR type: choice
   * Options: "Fully Implemented", "Partially Implemented", "Not Implemented"
   * Required: no
   */
  implementationStatus?:
    | "Fully Implemented"
    | "Partially Implemented"
    | "Not Implemented";

  /**
   * Confirm that your media disposal policy includes the following elements (click all that apply):
   * linkId: 698818405059
   * FHIR type: choice
   * Section: Policy Elements
   * Options: "Types of media covered by policy (Policy defines all types of media that may contain FCI (hard drives, SSDs, USB drives, etc.))", "Identification methods for FCI-containing media (Procedures for identifying media that contains or may contain FCI)", "Sanitization methods by media type (Specific sanitization methods appropriate for each media type)", "Destruction methods by media type (Specific destruction methods appropriate for each media type)", "Verification requirements (Procedures to verify sanitization or destruction was successful)", "Documentation requirements (Required records of sanitization and destruction activities)", "Roles and responsibilities (Designation of who is responsible for each aspect of media disposal)", "Compliance with relevant standards (References to NIST SP 800-88 or other applicable standards)"
   * Required: no
   */
  confirmThatYourMediaDisposalPolicyIncludesTheFollowingElementsClickAllThatApply?:
    | "Types of media covered by policy (Policy defines all types of media that may contain FCI (hard drives, SSDs, USB drives, etc.))"
    | "Identification methods for FCI-containing media (Procedures for identifying media that contains or may contain FCI)"
    | "Sanitization methods by media type (Specific sanitization methods appropriate for each media type)"
    | "Destruction methods by media type (Specific destruction methods appropriate for each media type)"
    | "Verification requirements (Procedures to verify sanitization or destruction was successful)"
    | "Documentation requirements (Required records of sanitization and destruction activities)"
    | "Roles and responsibilities (Designation of who is responsible for each aspect of media disposal)"
    | "Compliance with relevant standards (References to NIST SP 800-88 or other applicable standards)";
}

/** Convert an LHC JSON response into a normalized MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia object. */
export function mediaProtectionProtectInformationOnDigitalAndNonDigitalMediaLhcFormResponseAdapter(
  input: Any,
): MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia {
  return {
    doYouHaveAMediaDisposalPolicy: coerceOptionalString(
      findLhcValueByLinkId(input, "957584520694"),
    ),
    implementationStatus: coerceOptionalString(
      findLhcValueByLinkId(input, "272642906092"),
    ),
    confirmThatYourMediaDisposalPolicyIncludesTheFollowingElementsClickAllThatApply:
      coerceOptionalString(findLhcValueByLinkId(input, "698818405059")),
  };
}

/** Convert a FHIR QuestionnaireResponse into a normalized MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia object. */
export function mediaProtectionProtectInformationOnDigitalAndNonDigitalMediaFhirQuestionnaireResponseAdapter(
  qr: Any,
): MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia {
  return {
    doYouHaveAMediaDisposalPolicy: coerceOptionalString(
      findQrAnswerByLinkId(qr, "957584520694"),
    ),
    implementationStatus: coerceOptionalString(
      findQrAnswerByLinkId(qr, "272642906092"),
    ),
    confirmThatYourMediaDisposalPolicyIncludesTheFollowingElementsClickAllThatApply:
      coerceOptionalString(findQrAnswerByLinkId(qr, "698818405059")),
  };
}

/** High-level interpreter with factories, validation, and readiness scoring. */
export class MediaProtectionProtectInformationOnDigitalAndNonDigitalMediaInterpreter {
  constructor(
    readonly value:
      MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia,
  ) {}

  /** Factory: build from LHC JSON. */
  static fromLhcFormResponse(
    input: Any,
  ): MediaProtectionProtectInformationOnDigitalAndNonDigitalMediaInterpreter {
    return new MediaProtectionProtectInformationOnDigitalAndNonDigitalMediaInterpreter(
      mediaProtectionProtectInformationOnDigitalAndNonDigitalMediaLhcFormResponseAdapter(
        input,
      ),
    );
  }

  /** Factory: build from FHIR QuestionnaireResponse. */
  static fromQuestionnaireResponse(
    qr: Any,
  ): MediaProtectionProtectInformationOnDigitalAndNonDigitalMediaInterpreter {
    return new MediaProtectionProtectInformationOnDigitalAndNonDigitalMediaInterpreter(
      mediaProtectionProtectInformationOnDigitalAndNonDigitalMediaFhirQuestionnaireResponseAdapter(
        qr,
      ),
    );
  }

  /** Check required fields and report any missing or blank. */
  validateRequiredFields(): {
    ok: boolean;
    missing: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    >;
  } {
    const missing: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    > = [];
    const req: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    > = [];
    for (const k of req) {
      const v = (this.value as Any)[k];
      if (isBlank(v)) missing.push(k);
    }
    return { ok: missing.length === 0, missing };
  }

  /**
   * Assess readiness with a simple completeness score. This is meant to be
   * used to help understand how complete the types are and serves as an
   * example of how to use the generated code.
   * - requiredCovered: percentage of required fields that are non-blank
   * - overallFilled: count of non-blank fields among all known properties
   */
  assessReadiness(): {
    formTitle: string;
    requiredCovered: number; // 0..1
    totalRequired: number;
    totalFilled: number;
    totalFields: number;
    missingRequired: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    >;
  } {
    const req: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    > = [];
    const all: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    > = [
      "doYouHaveAMediaDisposalPolicy",
      "implementationStatus",
      "confirmThatYourMediaDisposalPolicyIncludesTheFollowingElementsClickAllThatApply",
    ];

    let reqFilled = 0;
    const missingReq: Array<
      keyof MediaProtectionProtectInformationOnDigitalAndNonDigitalMedia
    > = [];
    for (const k of req) {
      const v = (this.value as Any)[k];
      if (!isBlank(v)) reqFilled++;
      else missingReq.push(k);
    }

    let totalFilled = 0;
    for (const k of all) {
      if (!isBlank((this.value as Any)[k])) totalFilled++;
    }

    return {
      formTitle:
        "Media Protection (Protect information on digital and non-digital media)",
      requiredCovered: req.length ? reqFilled / req.length : 1,
      totalRequired: req.length,
      totalFilled,
      totalFields: all.length,
      missingRequired: missingReq,
    };
  }
}
